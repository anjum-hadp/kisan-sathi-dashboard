<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kisan Sathi - Progress Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2em;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            color: #666;
            font-size: 0.85em;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .stat-card.kashmir {
            border-left: 5px solid #3498db;
        }

        .stat-card.jammu {
            border-left: 5px solid #e74c3c;
        }

        .stat-card.total {
            border-left: 5px solid #27ae60;
        }

        .refresh-box {
            background: white;
            border-radius: 15px;
            padding: 15px 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .refresh-box button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 25px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
        }

        .refresh-box button:hover {
            opacity: 0.9;
        }

        .last-updated {
            color: #666;
            font-size: 0.9em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .tab:hover,
        .tab.active {
            background: white;
            color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .chart-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .chart-card h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1em;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .table-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
        }

        .table-section h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .controls input,
        .controls select {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            flex: 1;
            min-width: 200px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 10px 8px;
            border-bottom: 1px solid #eee;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .number {
            text-align: right;
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .project-cell {
            font-weight: 600;
            color: #333;
            width: 20%;
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.4;
        }

        .activity-cell {
            color: #666;
            font-size: 0.9em;
            width: 20%;
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.4;
        }

        .kashmir-col {
            color: #1565c0;
            font-weight: 600;
            background-color: #e3f2fd;
            border-radius: 4px;
            padding: 8px 6px;
        }

        .jammu-col {
            color: #c62828;
            font-weight: 600;
            background-color: #ffebee;
            border-radius: 4px;
            padding: 8px 6px;
        }

        .total-col {
            color: #2e7d32;
            font-weight: bold;
            background-color: #e8f5e9;
            border-radius: 4px;
            padding: 8px 6px;
        }

        footer {
            text-align: center;
            color: white;
            padding: 20px;
            opacity: 0.8;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>ğŸŒ¾ Kisan Sathi Dashboard</h1>
            <p>Jammu & Kashmir Agricultural Applications - Live Data</p>
        </header>

        <div id="loadingState" class="loading">â³ Loading data...</div>
        <div id="errorState" class="error" style="display:none"></div>

        <div id="dashboardContent" style="display:none">
            <div class="refresh-box">
                <span class="last-updated" id="lastUpdated"></span>
                <button onclick="loadData()">ğŸ”„ Refresh Data</button>
            </div>

            <div class="stats-grid">
                <div class="stat-card kashmir">
                    <h3> Kashmir Division</h3>
                    <div class="value" id="kashmir-apps">0</div>
                    <p>Appl</p>
                    <div style="margin-top:8px;font-size:0.9em"><span id="kashmir-appr">0</span> Appr (<span
                            id="kashmir-rate">0%</span>)</div>
                </div>
                <div class="stat-card jammu">
                    <h3> Jammu Division</h3>
                    <div class="value" id="jammu-apps">0</div>
                    <p>Appl</p>
                    <div style="margin-top:8px;font-size:0.9em"><span id="jammu-appr">0</span> Appr (<span
                            id="jammu-rate">0%</span>)</div>
                </div>
                <div class="stat-card total">
                    <h3>ğŸ“Š Grand Total</h3>
                    <div class="value" id="total-apps">0</div>
                    <p>Appl</p>
                    <div style="margin-top:8px;font-size:0.9em"><span id="total-appr">0</span> Appr (<span
                            id="total-rate">0%</span>)</div>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" onclick="showTab('overview')">ğŸ“Š Overview</div>
                <div class="tab" onclick="showTab('activities')">ğŸ“‹ Activity Details</div>
            </div>

            <div id="overview" class="tab-content active">
                <div class="chart-section">
                    <div class="chart-card">
                        <h3>Division-wise Distribution</h3>
                        <div class="chart-container"><canvas id="divisionChart"></canvas></div>
                    </div>
                    <div class="chart-card">
                        <h3>Top 10 Projects by Appl</h3>
                        <div class="chart-container"><canvas id="projectChart"></canvas></div>
                    </div>
                </div>
            </div>

            <div id="activities" class="tab-content">
                <div class="table-section">
                    <h2>ğŸ“‹ Project-wise Activity Details</h2>
                    <div class="controls">
                        <input type="text" id="searchInput" placeholder="ğŸ” Search project or activity...">
                        <select id="projectFilter">
                            <option value="">ğŸ“ All Projects</option>
                        </select>
                    </div>
                    <div id="activityTableContainer"></div>
                </div>
            </div>
        </div>

        <footer>
            <p>Data Source: Kisan Sathi Portal </p>
        </footer>
    </div>

    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // CONFIGURATION - EDIT THESE VALUES
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        // Your Google Sheet ID (from URL: https://docs.google.com/spreadsheets/d/SHEET_ID/edit)
        const SHEET_ID = '1VCR4YeCGJqMunaNdww3yyBY6JcxIn5CM7A-KDcTtVbY';

        // Your Google API Key (from Google Cloud Console)
        const API_KEY = 'AIzaSyCCOVdrw4MfiS43LM8yJ-lgQvk_irPAg08';

        // IMPORTANT: Restrict your API key in Google Cloud Console:
        // 1. Go to https://console.cloud.google.com/apis/credentials
        // 2. Click your API key
        // 3. Under "Application restrictions" â†’ HTTP referrers
        // 4. Add: *.github.io/* (or your specific domain)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        const KASHMIR_DISTRICTS = ['ANANTNAG', 'BANDIPORA', 'BARAMULLA', 'BUDGAM', 'GANDERBAL', 'KULGAM', 'KUPWARA', 'PULWAMA', 'SHOPIAN', 'SRINAGAR'];
        const JAMMU_DISTRICTS = ['DODA', 'JAMMU', 'KATHUA', 'KISHTWAR', 'POONCH', 'RAJOURI', 'RAMBAN', 'REASI', 'SAMBA', 'UDHAMPUR'];

        let rawSheetData = [];
        let targetsData = [];
        let processedData = [];
        let charts = {};

        // Auto-load on page load
        document.addEventListener('DOMContentLoaded', loadData);

        async function loadData() {
            document.getElementById('loadingState').style.display = 'block';
            document.getElementById('errorState').style.display = 'none';
            document.getElementById('dashboardContent').style.display = 'none';

            // Check if credentials are configured
            if (SHEET_ID === 'YOUR_SHEET_ID_HERE' || API_KEY === 'YOUR_API_KEY_HERE') {
                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('errorState').style.display = 'block';
                document.getElementById('errorState').innerHTML = `
                    <strong>âš ï¸ Dashboard Not Configured</strong><br><br>
                    Please edit the configuration section at the top of this file:<br>
                    1. Open index.html in a text editor<br>
                    2. Find "const SHEET_ID = 'YOUR_SHEET_ID_HERE'"<br>
                    3. Replace with your actual Sheet ID and API Key<br>
                    4. Save and re-upload to GitHub<br><br>
                    <a href="#" onclick="showConfigHelp()">Click here for detailed setup instructions</a>
                `;
                return;
            }

            try {
                // Fetch Raw Data tab
                const rawResponse = await fetch(
                    `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Raw%20Data?key=${API_KEY}`
                );

                if (!rawResponse.ok) {
                    const errorData = await rawResponse.json();
                    throw new Error(`${errorData.error?.message || 'Unknown error'} - Check Sheet ID and API Key`);
                }

                const rawJson = await rawResponse.json();
                rawSheetData = rawJson.values;

                if (!rawSheetData || rawSheetData.length < 5) {
                    throw new Error('Raw Data tab is empty or has wrong format');
                }

                // Process the raw server format
                processedData = processRawData(rawSheetData);

                if (processedData.length === 0) {
                    throw new Error('No data found after processing. Check sheet structure.');
                }

                // Fetch Targets tab
                try {
                    const targetsResponse = await fetch(
                        `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Targets?key=${API_KEY}`
                    );
                    if (targetsResponse.ok) {
                        const targetsJson = await targetsResponse.json();
                        targetsData = parseSimpleData(targetsJson.values);
                        console.log('Targets loaded:', targetsData.length, 'rows');
                    } else {
                        console.log('Targets tab not accessible');
                        targetsData = [];
                    }
                } catch (e) {
                    console.log('Error loading targets:', e);
                    targetsData = [];
                }

                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('dashboardContent').style.display = 'block';
                document.getElementById('lastUpdated').textContent = `Last updated: ${new Date().toLocaleString()}`;

                initDashboard();

            } catch (error) {
                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('errorState').style.display = 'block';
                document.getElementById('errorState').innerHTML = `
                    <strong>âŒ Error loading data:</strong><br>
                    ${error.message}<br><br>
                    <strong>Troubleshooting:</strong><br>
                    1. Verify Sheet ID is correct<br>
                    2. Verify API Key is correct and Sheets API is enabled<br>
                    3. Make sure sheet is shared as "Anyone with link can VIEW"<br>
                    4. Check that "Raw Data" tab exists with correct structure
                `;
                console.error('Full error:', error);
            }
        }

        function processRawData(values) {
            const districtRow = values[2];  // Row 3 - district names
            const dataRows = values.slice(4); // Row 5+ - actual data

            const districtCols = {};
            districtRow.forEach((val, idx) => {
                if (val && val.trim) districtCols[val.trim()] = idx;
            });

            const processed = [];

            dataRows.forEach(row => {
                if (!row[0]) return;

                const project = row[0];
                const activity = row[1] || '';

                let kAppl = 0, kAppr = 0;
                KASHMIR_DISTRICTS.forEach(d => {
                    if (districtCols[d] !== undefined) {
                        const col = districtCols[d];
                        kAppl += parseInt(row[col]) || 0;
                        kAppr += parseInt(row[col + 1]) || 0;
                    }
                });

                let jAppl = 0, jAppr = 0;
                JAMMU_DISTRICTS.forEach(d => {
                    if (districtCols[d] !== undefined) {
                        const col = districtCols[d];
                        jAppl += parseInt(row[col]) || 0;
                        jAppr += parseInt(row[col + 1]) || 0;
                    }
                });

                processed.push({
                    Project: project,
                    Activity: activity,
                    'K-Appl': kAppl,
                    'J-Appl': jAppl,
                    'K-Appr': kAppr,
                    'J-Appr': jAppr,
                    'Total-Appl': kAppl + jAppl,
                    'Total-Appr': kAppr + jAppr
                });
            });

            return processed;
        }

        function parseSimpleData(values) {
            if (!values || values.length < 2) return [];
            const headers = values[0].map(h => String(h || '').trim());
            const data = [];
            for (let i = 1; i < values.length; i++) {
                if (!values[i] || !values[i][0]) continue;
                const row = {};
                headers.forEach((h, idx) => {
                    row[h] = values[i][idx] !== undefined ? String(values[i][idx]) : '';
                });
                data.push(row);
            }
            return data;
        }

        function getTarget(project, activity) {
            if (!project || !activity || !targetsData || targetsData.length === 0) return '-';

            const proj = String(project).toLowerCase().trim();
            const act = String(activity).toLowerCase().trim();

            // Try exact match first
            let match = targetsData.find(t => {
                const tProj = String(t.Project || '').toLowerCase().trim();
                const tAct = String(t.Activity || '').toLowerCase().trim();
                return proj === tProj && act === tAct;
            });

            // Try partial match
            if (!match) {
                match = targetsData.find(t => {
                    const tProj = String(t.Project || '').toLowerCase().trim();
                    const tAct = String(t.Activity || '').toLowerCase().trim();
                    return (proj.includes(tProj) || tProj.includes(proj)) &&
                        (act.includes(tAct) || tAct.includes(act));
                });
            }

            if (match) {
                const target = match['5-Year Targets'] || match['5-Year Target'] || match.Target || match.target || '';
                const unit = match.Units || match.Unit || match.units || match.unit || '';
                if (target && unit) return target + ' ' + unit;
                if (target) return target;
                if (unit) return unit;
            }
            return '-';
        }

        function initDashboard() {
            calculateTotals();
            initCharts();
            populateFilters();
            renderActivityTable();
        }

        function calculateTotals() {
            let kApps = 0, kAppr = 0, jApps = 0, jAppr = 0;
            processedData.forEach(row => {
                kApps += row['K-Appl'];
                kAppr += row['K-Appr'];
                jApps += row['J-Appl'];
                jAppr += row['J-Appr'];
            });

            document.getElementById('kashmir-apps').textContent = kApps.toLocaleString();
            document.getElementById('kashmir-appr').textContent = kAppr.toLocaleString();
            document.getElementById('kashmir-rate').textContent = kApps > 0 ? ((kAppr / kApps) * 100).toFixed(1) + '%' : '0%';

            document.getElementById('jammu-apps').textContent = jApps.toLocaleString();
            document.getElementById('jammu-appr').textContent = jAppr.toLocaleString();
            document.getElementById('jammu-rate').textContent = jApps > 0 ? ((jAppr / jApps) * 100).toFixed(1) + '%' : '0%';

            document.getElementById('total-apps').textContent = (kApps + jApps).toLocaleString();
            document.getElementById('total-appr').textContent = (kAppr + jAppr).toLocaleString();
            document.getElementById('total-rate').textContent = (kApps + jApps) > 0 ? (((kAppr + jAppr) / (kApps + jApps)) * 100).toFixed(1) + '%' : '0%';
        }

        function initCharts() {
            if (charts.division) charts.division.destroy();
            if (charts.project) charts.project.destroy();

            let kTotal = 0, jTotal = 0;
            processedData.forEach(row => {
                kTotal += row['K-Appl'];
                jTotal += row['J-Appl'];
            });

            charts.division = new Chart(document.getElementById('divisionChart'), {
                type: 'doughnut',
                data: { labels: ['Kashmir Division', 'Jammu Division'], datasets: [{ data: [kTotal, jTotal], backgroundColor: ['#3498db', '#e74c3c'] }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
            });

            const projectTotals = {};
            processedData.forEach(row => {
                if (!projectTotals[row.Project]) projectTotals[row.Project] = 0;
                projectTotals[row.Project] += row['Total-Appl'];
            });
            const sorted = Object.entries(projectTotals).sort((a, b) => b[1] - a[1]).slice(0, 10);

            charts.project = new Chart(document.getElementById('projectChart'), {
                type: 'bar',
                data: { labels: sorted.map(p => p[0].substring(0, 25) + '...'), datasets: [{ label: 'Appl', data: sorted.map(p => p[1]), backgroundColor: '#667eea' }] },
                options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false } } }
            });
        }

        function populateFilters() {
            const projects = [...new Set(processedData.map(r => r.Project))].filter(p => p).sort();
            const select = document.getElementById('projectFilter');
            select.innerHTML = '<option value="">All Projects</option>';
            projects.forEach(p => { const opt = document.createElement('option'); opt.value = p; opt.textContent = p; select.appendChild(opt); });

            document.getElementById('searchInput').addEventListener('input', renderActivityTable);
            document.getElementById('projectFilter').addEventListener('change', renderActivityTable);
        }

        function renderActivityTable() {
            const container = document.getElementById('activityTableContainer');
            const search = document.getElementById('searchInput')?.value?.toLowerCase() || '';
            const project = document.getElementById('projectFilter')?.value || '';

            let filtered = processedData;
            if (search) filtered = filtered.filter(r => r.Project.toLowerCase().includes(search) || r.Activity.toLowerCase().includes(search));
            if (project) filtered = filtered.filter(r => r.Project === project);

            let html = '<table><thead><tr>';
            html += '<th style="width:20%;white-space:normal;line-height:1.3;">Project</th>';
            html += '<th style="width:20%;white-space:normal;line-height:1.3;">Activity</th>';
            html += '<th class="number" style="background:#1565c0;color:white;width:8%;font-size:11px;line-height:1.3;padding:10px 4px;">Kashmir<br>Applications</th>';
            html += '<th class="number" style="background:#c62828;color:white;width:8%;font-size:11px;line-height:1.3;padding:10px 4px;">Jammu<br>Applications</th>';
            html += '<th class="number" style="background:#1a237e;color:white;width:8%;font-size:11px;line-height:1.3;padding:10px 4px;">Total<br>Applications</th>';
            html += '<th class="number" style="background:#0d47a1;color:white;width:8%;font-size:11px;line-height:1.3;padding:10px 4px;">Kashmir<br>Approvals</th>';
            html += '<th class="number" style="background:#b71c1c;color:white;width:8%;font-size:11px;line-height:1.3;padding:10px 4px;">Jammu<br>Approvals</th>';
            html += '<th class="number" style="background:#1b5e20;color:white;width:8%;font-size:11px;line-height:1.3;padding:10px 4px;">Total<br>Approvals</th>';
            html += '<th class="number" style="background:#4a148c;color:white;width:8%;font-size:11px;line-height:1.3;padding:10px 4px;">5-Year<br>Targets</th>';
            html += '</tr></thead><tbody>';

            filtered.forEach(row => {
                const tgt = getTarget(row.Project, row.Activity);
                html += `<tr>
                    <td class="project-cell">${row.Project}</td>
                    <td class="activity-cell">${row.Activity}</td>
                    <td class="number" style="color:#1565c0;background:#e3f2fd;font-weight:600">${row['K-Appl'].toLocaleString()}</td>
                    <td class="number" style="color:#c62828;background:#ffebee;font-weight:600">${row['J-Appl'].toLocaleString()}</td>
                    <td class="number" style="color:#1a237e;background:#e8eaf6;font-weight:700">${row['Total-Appl'].toLocaleString()}</td>
                    <td class="number" style="color:#0d47a1;background:#e3f2fd;font-weight:600">${row['K-Appr'].toLocaleString()}</td>
                    <td class="number" style="color:#b71c1c;background:#ffebee;font-weight:600">${row['J-Appr'].toLocaleString()}</td>
                    <td class="number" style="color:#1b5e20;background:#e8f5e9;font-weight:700">${row['Total-Appr'].toLocaleString()}</td>
                    <td class="number" style="color:#4a148c;background:#f3e5f5;font-weight:700">${tgt}</td>
                </tr>`;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function showConfigHelp() {
            alert(`Setup Instructions:

1. Get Sheet ID:
   - Open your Google Sheet
   - Copy the ID from URL (between /d/ and /edit)
   - Example: 1ABC123xyz...

2. Get API Key:
   - Go to console.cloud.google.com
   - Create project â†’ Enable Sheets API
   - Create API Key

3. Edit index.html:
   - Open in text editor
   - Find SHEET_ID and API_KEY
   - Replace with your values

4. Restrict API Key (important!):
   - In Cloud Console, click your API key
   - HTTP referrers â†’ Add your domain
   - Example: *.github.io/*`);
        }

        // Auto-refresh every 30 minutes
        setInterval(() => { if (SHEET_ID !== 'YOUR_SHEET_ID_HERE') loadData(); }, 1800000000);
    </script>
</body>

</html>
